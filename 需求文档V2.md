# 批量文件处理工具需求文档

## 1. 项目概述

批量文件处理工具是一个基于Python开发的桌面应用程序，旨在提供一套完整的文件批量处理解决方案。该工具提供了友好的图形用户界面，支持多种文件操作功能，包括批量创建文件、批量创建目录、批量创建工作表、批量重命名以及批量移动/复制等功能。

## 2. 系统架构

### 2.1 技术栈
- 开发语言：Python
- GUI框架：Tkinter（Python标准库）
- 日志系统：Python logging模块
- 文件处理：os模块
- Excel处理：openpyxl库

### 2.2 目录结构
```
src/
├── main.py              # 程序入口文件，负责初始化 Tkinter 应用并加载主窗口
├── ui/                  # 用户界面相关代码目录
│   ├── main_window.py   # 主窗口实现文件，包含顶部菜单栏、选项卡式布局和底部状态栏的创建
│   ├── styles/          # 样式配置目录
│   │   └── tk_styles.py # 用于配置 Tkinter 样式，借助 ttk.Style 实现样式自定义
│   └── tabs/            # 功能选项卡目录
│       ├── create_files_tab.py    # 批量创建文件功能选项卡实现
│       ├── create_dirs_tab.py     # 批量创建目录功能选项卡实现
│       ├── create_sheets_tab.py   # 批量创建工作表功能选项卡实现
│       ├── rename_tab.py          # 批量重命名功能选项卡实现
│       └── move_copy_tab.py       # 批量移动/复制功能选项卡实现
├── utils/               # 工具函数目录
│   ├── file_utils.py    # 文件操作工具函数，如批量创建文件、目录，重命名，移动/复制等
│   ├── excel_utils.py   # Excel 操作工具函数，如批量创建工作表
│   └── log_utils.py     # 日志系统工具函数，负责日志的记录、分割等操作
├── resources/           # 资源文件目录
│   ├── icons/           # 图标文件目录，存放应用所需的图标
│   │   ├── logo.ico     # 应用图标
│   │   └── ...
│   └── ads/             # 广告资源目录，存放广告图片、文本等
│       ├── ad1.png
│       └── ...
├── tests/               # 测试代码目录
│   ├── test_file_utils.py # 测试文件操作工具函数
│   ├── test_excel_utils.py # 测试 Excel 操作工具函数
│   └── ...
├── docs/                # 文档目录
│   ├── user_manual.md   # 用户手册，介绍应用的使用方法
│   ├── developer_guide.md # 开发指南，包含代码结构、接口定义等信息
│   └── ...
├── requirements.txt     # 项目依赖文件，列出项目所需的第三方库
└── README.md            # 项目说明文件，介绍项目的基本信息、安装方法等
```


## 3. 功能模块

### 3.1 主界面
- 顶部菜单栏：
  - 官网：链接到产品官方网站
  - 赞赏：显示赞赏信息
  - 广告：显示广告信息
  - 帮助：显示帮助信息
  - 关于：显示软件版本等信息
- 选项卡式布局
- 底部状态栏

### 3.2 批量创建文件
- 功能描述：批量创建指定数量的空文件
- 界面元素：
- **输入区域**：
  - 名称输入方式：直接输入/从文件导入（单选），文件导入支持格式csv、txt、excel文件，且可以选择是否包含表头
  - 多行文本框："请输入文件名列表，每行一个文件名"
  - 辅助按钮："从剪贴板粘贴"、"清空"
- **命名规则**：直接使用输入名称/自定义规则（单选）

#### **自定义命名规则选择时候**
- **单选按钮组**：
  - `直接使用输入名称`（默认选择）
  - `自定义命名规则`

#### **2. 自定义规则设置区域**（当选择"自定义命名规则"时显示）
| **组件**          | **功能说明**                                                                 | **示例/选项**                          |
|-------------------|-----------------------------------------------------------------------------|----------------------------------------|
| **命名模式输入框** | 支持变量插值的文本输入框                                                    | `前缀_$NAME1_$ISEQ3_$YYYY$MM$DD_后缀` |
| **变量说明标签**   | 显示可用变量及其含义                                                        | `$NAME1=输入名称, $ISEQ1=序号...`      |
| **序号设置**       | - 起始值（默认1）<br>- 步长（默认1）<br>- 位数（默认3，自动补零）            | 输入数字                               |

- **输出设置**：
  - 目标路径输入框 + "浏览"按钮（显示`C:\Users\zhang`）
  - 文件类型下拉框（当前选中`.txt`）
  - 内容模板文本框（支持变量如`${NAME}`）
- **预览区域**：
  - 表格显示："序号|原始输入|生成文件名|完整路径"
  - 底部按钮："预览"、"执行"
  
- 操作流程：
  1. 选择目标文件
  2. 设置命名规则
  3. 输出设置：目标路径、文件类型选择、内容模板（默认为空）
  4. 预览生成结果
  5. 执行创建操作
- 特性：
  - 支持文本粘贴或者上传csv、txt、excel文件
  - 创建前预览
  - 文件已存在时的覆盖确认
  - 错误处理和提示

### 3.3 批量创建目录
- 功能描述：批量创建指定数量的目录
#### **界面描述**：
- **目录名称输入**：
  - 输入方式：直接输入/从文件导入（单选）
  - 多行文本框（支持缩进表示层级，提示"使用Tab或空格缩进"）
- **层级结构设置**：
  - 复选框"启用层级结构" + 数字输入"缩进空格数:4"
- **命名规则**：同创建文件功能
- **输出设置**：目标路径浏览
- **预览表格**：
  - 列名："序号|原始输入|生成目录名|完整路径"
  - 操作按钮："预览"、"执行"

### 3.4 批量创建工作表
- 功能描述：在Excel文件中批量创建工作表
#### **界面描述**：
- **工作表名称输入**：
  - 输入方式：直接输入/从Excel导入（单选）
  - 多行文本框 + "从剪贴板粘贴"、"清空"按钮
- **输出设置**：
  - 输出文件浏览
  - 文件格式固定显示"Excel文件 (xlsx)"
- **表格格式设置**：
  - 复选框"创建标题行"（关联标题文本输入框）
  - 复选框"创建表头行"（带表头名称输入）
- **预览表格**：
  - 列名："序号|工作表名称|包含内容"
  - 操作按钮："预览"、"执行"

### 3.5 批量重命名
- 功能描述：批量重命名文件或目录
#### **界面描述**：
- **文件选择**：
  - 按钮："选择文件"、"选择目录"、"清空选择"
  - 提示文字支持拖放和右键删除
- **重命名规则**：
  - 规则类型下拉（当前选中"替换文本"）
  - "查找文本"、"替换为"输入框 + "区分大小写"复选框
- **作用范围**：单选"文件名/目录名"或"扩展名"
- **预览表格**：
  - 列名："原始名称|新名称|路径"
  - 操作按钮："预览"、"执行"

### 3.6 批量移动/复制
- 功能描述：批量移动或复制文件/目录
#### **界面描述**：
- **文件选择**：同重命名功能
- **操作设置**：
  - 单选按钮："移动"或"复制"（默认复制）
  - 目标路径浏览
  - 冲突处理单选："覆盖"、"跳过"、"重命名"
  - 复选框"保留目录结构"
- **预览表格**：
  - 列名："源路径|目标路径|操作"
  - 操作按钮："预览"、"执行"

## 4. 系统特性

### 4.1 日志系统
- 详细的日志记录
- 按日期自动分割日志文件
- 支持不同级别的日志
- 记录系统环境信息
- 未捕获异常的处理

### 4.2 错误处理
- 友好的错误提示
- 详细的错误日志
- 异常处理机制
- 操作确认机制

### 4.3 用户界面
#### **1. 整体布局风格**
**分类**：模块化卡片式布局 + 选项卡导航  
**特点**：
- **功能分区明确**：采用`LabelFrame`将不同功能组（如输入区、规则设置区、操作区）用视觉边框分隔，符合Fitts定律的操作热区划分。
- **垂直流式布局**：从上至下依次为`菜单栏 → 功能选项卡 → 输入模块 → 设置模块 → 操作按钮`，符合自然视线Z型浏览路径。
- **响应式密度控制**：元素间距遵循8px网格系统（如按钮间默认5-10px padding），避免视觉拥挤。
---

#### **2. 核心设计特征**
##### **(1) 输入区域设计**
| **组件** | **设计模式**                      | **用户体验优化**              |
| ------ | ----------------------------- | ----------------------- |
| 多行文本框  | 扩展型输入容器                       | 高度固定为5-10行，支持滚动条和Tab缩进  |
| 文件导入选项 | 渐进式披露（Progressive Disclosure） | 仅当选择"从文件导入"时才显示路径浏览控件   |
| 变量输入提示 | 内联标注（Inline Annotation）       | 灰色小字说明变量用法（如`$ISEQ=序号`） |

##### **(2) 导航与操作**
- **选项卡导航**：采用`ttk.Notebook`实现平铺式标签页，当前选中标签高亮（背景色`#D0D0D0`）
- **按钮分级**：
  - 主操作按钮（如"执行"）：蓝色（`#0078D7`）+ 加粗文字
  - 次要按钮（如"清空"）：灰色边框（`#E0E0E0`）无填充

##### **(3) 预览反馈**
- **表格预览**：斑马条纹（Zebra Striping）设计，奇偶行不同背景色（`#FFFFFF`/`#F5F5F5`）
- **实时生效**：规则修改后自动更新预览（或通过"预览"按钮触发）

---

#### **3. 视觉风格描述**
| **属性**         | **说明**                                                                 |
|------------------|-------------------------------------------------------------------------|
| **色彩体系**     | 中性色主导（灰/白）+ 强调色（蓝色主按钮），符合WCAG 2.1对比度标准       |
| **字体层级**     | 三级文本：<br>- 标题（12pt加粗）<br>- 正文（10pt常规）<br>- 提示（9pt浅灰） |
| **控件一致性**   | 所有输入框高度统一（28px），按钮圆角半径（4px）                          |
| **留白策略**     | 模块间大间距（20px），模块内小间距（8px）                               |

---

#### **4. 交互设计亮点**
1. **动态界面**  
   ```python
   # 示例：单选按钮控制显隐
   rule_type.trace("w", lambda *_: custom_frame.pack() if rule_type.get()==1 else custom_frame.pack_forget())
   ```
2. **输入引导**  
   - 文本框默认提示文字（如"每行一个名称"）
   - 变量输入时显示浮动提示面板

3. **防御式设计**  
   - 关键操作（如覆盖文件）前二次确认
   - 禁用无效按钮（如未选择文件时禁用"执行"）

### 4.4 可扩展性
- 模块化设计
- 清晰的代码结构
- 统一的接口定义
- 便于添加新功能

## 5. 开发规范

### 5.1 代码规范
- 遵循PEP 8编码规范
- 清晰的代码注释
- 统一的命名规范
- 模块化的代码组织

### 5.2 文档规范
- 详细的代码注释
- 完整的功能文档
- 清晰的接口文档
- 版本更新记录

### 5.3 版本控制
- 语义化版本号
- 清晰的版本更新说明
- 完整的更新日志

## 6. 部署要求

### 6.1 系统要求
- 操作系统：Windows/Linux/MacOS
- Python版本：3.6+
- 内存要求：≥4GB
- 磁盘空间：≥100MB

### 6.2 依赖项
- openpyxl
- logging
- 其他Python标准库（Tkinter是Python标准库，无需额外安装）